{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>community</title>
   
    <link rel="stylesheet" href="{% static 'css/community.css' %}">
    <script>
        // JavaScriptì—ì„œ Djangoì˜ URLì„ ë³€ìˆ˜ë¡œ ì„¤ì •
        const postCreateUrl = "{% url 'post_create' %}";
        const communityUrl = "{% url 'community' %}";
        // ë‹¤ë¥¸ í˜ì´ì§€ì˜ URLë„ í•„ìš”í•œ ê²½ìš° ì¶”ê°€ë¡œ ì„¤ì • ê°€ëŠ¥
    </script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <button class="back-btn">
                    <img src="../../static/images/back_icon.png" alt="ëŒì•„ê°€ê¸°">
                </button>
                <p class="page-title">ì»¤ë®¤ë‹ˆí‹°</p>
                <button class="search-btn">
                    <img src="../../static/images/search_header_icon.png" alt="ê²€ìƒ‰">
                </button>
                <button class="home-btn">
                    <img src="../../static/images/home_icon.png" alt="í™ˆ">
                </button>
            </div>
        </header>
            <main>
                <div class="whats-new-section">
                    <div class="whats-new-header">
                        <p class="whatsnew">What's New</p>
                        <button class="add-story-btn" onclick="toggleModal('story-modal', event)">
                            <img src="../../static/images/story_icon.png" alt="+">
                        </button>
                    </div>
                    {% for post in posts %}
                    <div class="profile-post-row">
                        <div class="profile">
                            {% if post.user == request.user %}
                            <!-- í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì¼ ê²½ìš° -->
                            <img src="{{ request.user.userprofile.profile_picture.url }}" alt="í”„ë¡œí•„ ì‚¬ì§„">
                            <div class="profile-info">
                                <p class="profile-id">{{ request.user.userprofile.mom_id }}</p>
                                <!-- ì¶”ê°€ì ì¸ í”„ë¡œí•„ ì •ë³´ëŠ” ì—¬ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ -->
                            </div>
                        {% else %}
                            <!-- ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ê²½ìš° -->
                            <img src="{{ post.user.userprofile.profile_picture.url }}" alt="í”„ë¡œí•„ ì‚¬ì§„">
                            <div class="profile-info">
                                <p class="profile-id">{{ post.user.userprofile.mom_id }}</p>
                                <!-- ì¶”ê°€ì ì¸ í”„ë¡œí•„ ì •ë³´ëŠ” ì—¬ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ -->
                            </div>
                        {% endif %}
                        </div>
                        <div class="post">
                            <div class="post-images">
                                <img src="{{ post.image.url }}" alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€" class="post-image-horizontal">
                                <div class="post-content">
                                    <div class="heart-and-like">
                                        <form action="{% url 'like_post' post.id %}" method="post">
                                            {% csrf_token %}
                                            <button type="submit" class="heart-icon">
                                                {% if post.id in liked_posts %}
                                                    â¤ï¸
                                                {% else %}
                                                    ğŸ¤
                                                {% endif %}
                                            </button>
                                        </form>
                                        <span>{{ post.likes.count }}</span>
                                    </div>
                                    <p class="post-text">{{ post.content }}</p>
                                </div>
                            </div>
                            <img src="{{ post.image.url }}" alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€" class="post-image-vertical">
                            <a href="{% url 'post_update' post.id %}">
                                <img src="../../static/images/post_edit.png" alt="ìˆ˜ì •" width="20px">
                            </a>
                            <a href="{% url 'post_update' post.id %}">
                                <img src="../../static/images/post_delete.png" alt="ì‚­ì œ" width="20px">
                            </a>
                        </div>
                    </div>
                    {% endfor %}
            </main>
    
            <footer>
                <nav class="bottom-nav"> <!-- í•˜ë‹¨ì˜ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
                    <a href="{% url 'mainpage:home' %}"><img src="../../static/images/home_icon.png" alt="í™ˆ ì•„ì´ì½˜"></a>
                    <a href="../baby/baby.html"><img src="../../static/images/nav_baby.png" alt="ì•„ì´ ì•„ì´ì½˜"></a>
                    <a href="../me/me.html"><img src="../../static/images/nav_me.png" alt="ë‚˜ ì•„ì´ì½˜"></a>
                    <a href="../location/location.html"><img src="../../static/images/nav_location.png" alt="ì¥ì†Œ ì•„ì´ì½˜"></a>
                    <a href="{% url 'community' %}"><img src="../../static/images/nav_community.png" alt="ì»¤ë®¤ë‹ˆí‹° ì•„ì´ì½˜"></a>
                </nav>
            </footer>
        </div>
   

    <!-- ëª¨ë‹¬ì°½ -->
    <div id="story-modal" class="modal" onclick="toggleModal('story-modal', event)">
        <div class="modal-content">
            <button class="story-btn" onclick="goToStoryPage()">ìŠ¤í† ë¦¬</button>
            <button class="post-btn" onclick="goToPostPage()">ê²Œì‹œë¬¼</button>            
        </div>
    </div>

    <div id="modal" class="modal" onclick="toggleModal('modal', event)">
        <div class="modal-content">
            <button class="edit-btn" onclick="goToRevisePage()">ìˆ˜ì •</button>
            <button class="delete-btn" onclick="toggleModal('delete-modal', event)">ì‚­ì œ</button>
        </div>
    </div>

    <!-- ì‚­ì œ ëª¨ë‹¬ -->
    <!-- <div id="delete-modal" class="delete-modal-content">
        <p class="ruok">ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p><p><br>ì´ ê²Œì‹œë¬¼ê³¼ ê´€ë ¨ëœ ë‚´ìš©ì´<br>ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.</p>
            <div class="delete-modal-buttons">
                <button class="confirm-btn" onclick="toggleDeleteModal()">ë„¤</button>
                <button class="cancel-btn" onclick="toggleDeleteModal()">ì•„ë‹ˆì˜¤</button>
            </div>
    </div> -->

<!-- ë°˜íˆ¬ëª… í°ìƒ‰ ë°°ê²½ ì˜¤ë²„ë ˆì´ -->
<div id="overlay" class="overlay" onclick="toggleDeleteModal()"></div>


<script src="{% static 'js/community.js' %}"></script>
</body>
</html>